(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47638],{47638:(t,e,n)=>{"use strict";n.r(e),n.d(e,{render:()=>p});var i=n(13233),o=n(12331),a=n(67334),r=n(41985);function d(t,e){t.forEach(t=>{let n={id:t.id,labelText:t.label,height:t.height,width:t.width,padding:t.padding??0};Object.keys(t).forEach(e=>{["id","label","height","width","padding","x","y"].includes(e)||(n[e]=t[e])}),e.add({group:"nodes",data:n,position:{x:t.x??0,y:t.y??0}})})}function s(t,e){t.forEach(t=>{let n={id:t.id,source:t.start,target:t.end};Object.keys(t).forEach(e=>{["id","start","end"].includes(e)||(n[e]=t[e])}),e.add({group:"edges",data:n})})}function l(t){return new Promise(e=>{let n=(0,r.Ltv)("body").append("div").attr("id","cy").attr("style","display:none"),a=(0,o.A)({container:document.getElementById("cy"),style:[{selector:"edge",style:{"curve-style":"bezier"}}]});n.remove(),d(t.nodes,a),s(t.edges,a),a.nodes().forEach(function(t){t.layoutDimensions=()=>{let e=t.data();return{w:e.width,h:e.height}}}),a.layout({name:"cose-bilkent",quality:"proof",styleEnabled:!1,animate:!1}).run(),a.ready(t=>{i.Rm.info("Cytoscape ready",t),e(a)})})}function u(t){return t.nodes().map(t=>{let e=t.data(),n=t.position(),i={id:e.id,x:n.x,y:n.y};return Object.keys(e).forEach(t=>{"id"!==t&&(i[t]=e[t])}),i})}function g(t){return t.edges().map(t=>{let e=t.data(),n=t._private.rscratch,i={id:e.id,source:e.source,target:e.target,startX:n.startX,startY:n.startY,midX:n.midX,midY:n.midY,endX:n.endX,endY:n.endY};return Object.keys(e).forEach(t=>{["id","source","target"].includes(t)||(i[t]=e[t])}),i})}async function c(t,e){i.Rm.debug("Starting cose-bilkent layout algorithm");try{y(t);let e=await l(t),n=u(e),o=g(e);return i.Rm.debug(`Layout completed: ${n.length} nodes, ${o.length} edges`),{nodes:n,edges:o}}catch(t){throw i.Rm.error("Error in cose-bilkent layout algorithm:",t),t}}function y(t){if(!t)throw Error("Layout data is required");if(!t.config)throw Error("Configuration is required in layout data");if(!t.rootNode)throw Error("Root node is required");if(!t.nodes||!Array.isArray(t.nodes))throw Error("No nodes found in layout data");if(!Array.isArray(t.edges))throw Error("Edges array is required in layout data");return!0}o.A.use(a),(0,i.K2)(d,"addNodes"),(0,i.K2)(s,"addEdges"),(0,i.K2)(l,"createCytoscapeInstance"),(0,i.K2)(u,"extractPositionedNodes"),(0,i.K2)(g,"extractPositionedEdges"),(0,i.K2)(c,"executeCoseBilkentLayout"),(0,i.K2)(y,"validateLayoutData");var p=(0,i.K2)(async(t,e,{insertCluster:n,insertEdge:i,insertEdgeLabel:o,insertMarkers:a,insertNode:r,log:d,positionEdgeLabel:s},{algorithm:l})=>{let u={},g={},y=e.select("g");a(y,t.markers,t.type,t.diagramId);let p=y.insert("g").attr("class","subgraphs"),E=y.insert("g").attr("class","edgePaths"),h=y.insert("g").attr("class","edgeLabels"),f=y.insert("g").attr("class","nodes");d.debug("Inserting nodes into DOM for dimension calculation"),await Promise.all(t.nodes.map(async e=>{if(e.isGroup){let t={...e};g[e.id]=t,u[e.id]=t,await n(p,e)}else{let n={...e};u[e.id]=n;let i=await r(f,e,{config:t.config,dir:t.direction||"TB"}),o=i.node().getBBox();n.width=o.width,n.height=o.height,n.domId=i,d.debug(`Node ${e.id} dimensions: ${o.width}x${o.height}`)}})),d.debug("Running cose-bilkent layout algorithm");let L={...t,nodes:t.nodes.map(t=>{let e=u[t.id];return{...t,width:e.width,height:e.height}})},T=await c(L,t.config);d.debug("Positioning nodes based on layout results"),T.nodes.forEach(t=>{let e=u[t.id];e?.domId&&(e.domId.attr("transform",`translate(${t.x}, ${t.y})`),e.x=t.x,e.y=t.y,d.debug(`Positioned node ${e.id} at center (${t.x}, ${t.y})`))}),T.edges.forEach(e=>{let n=t.edges.find(t=>t.id===e.id);n&&(n.points=[{x:e.startX,y:e.startY},{x:e.midX,y:e.midY},{x:e.endX,y:e.endY}])}),d.debug("Inserting and positioning edges"),await Promise.all(t.edges.map(async e=>{await o(h,e);let n=u[e.start??""],a=u[e.end??""];if(n&&a){let o=T.edges.find(t=>t.id===e.id);if(o){d.debug("APA01 positionedEdge",o);let r={...e},l=i(E,r,g,t.type,n,a,t.diagramId);s(r,l)}else{let o={...e,points:[{x:n.x||0,y:n.y||0},{x:a.x||0,y:a.y||0}]},r=i(E,o,g,t.type,n,a,t.diagramId);s(o,r)}}})),d.debug("Cose-bilkent rendering completed")},"render")},67334:function(t,e,n){t.exports=function(t){var e=[function(e,n){e.exports=t},function(t,e,n){"use strict";var i=n(0).layoutBase.LayoutConstants,o=n(0).layoutBase.FDLayoutConstants,a=n(0).CoSEConstants,r=n(0).CoSELayout,d=n(0).CoSENode,s=n(0).layoutBase.PointD,l=n(0).layoutBase.DimensionD,u={ready:function(){},stop:function(){},quality:"default",nodeDimensionsIncludeLabels:!1,refresh:30,fit:!0,padding:10,randomize:!0,nodeRepulsion:4500,idealEdgeLength:50,edgeElasticity:.45,nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,animate:"end",animationDuration:500,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.5};function g(t){this.options=function(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n}(u,t),c(this.options)}var c=function(t){null!=t.nodeRepulsion&&(a.DEFAULT_REPULSION_STRENGTH=o.DEFAULT_REPULSION_STRENGTH=t.nodeRepulsion),null!=t.idealEdgeLength&&(a.DEFAULT_EDGE_LENGTH=o.DEFAULT_EDGE_LENGTH=t.idealEdgeLength),null!=t.edgeElasticity&&(a.DEFAULT_SPRING_STRENGTH=o.DEFAULT_SPRING_STRENGTH=t.edgeElasticity),null!=t.nestingFactor&&(a.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=o.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=t.nestingFactor),null!=t.gravity&&(a.DEFAULT_GRAVITY_STRENGTH=o.DEFAULT_GRAVITY_STRENGTH=t.gravity),null!=t.numIter&&(a.MAX_ITERATIONS=o.MAX_ITERATIONS=t.numIter),null!=t.gravityRange&&(a.DEFAULT_GRAVITY_RANGE_FACTOR=o.DEFAULT_GRAVITY_RANGE_FACTOR=t.gravityRange),null!=t.gravityCompound&&(a.DEFAULT_COMPOUND_GRAVITY_STRENGTH=o.DEFAULT_COMPOUND_GRAVITY_STRENGTH=t.gravityCompound),null!=t.gravityRangeCompound&&(a.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=o.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=t.gravityRangeCompound),null!=t.initialEnergyOnIncremental&&(a.DEFAULT_COOLING_FACTOR_INCREMENTAL=o.DEFAULT_COOLING_FACTOR_INCREMENTAL=t.initialEnergyOnIncremental),"draft"==t.quality?i.QUALITY=0:"proof"==t.quality?i.QUALITY=2:i.QUALITY=1,a.NODE_DIMENSIONS_INCLUDE_LABELS=o.NODE_DIMENSIONS_INCLUDE_LABELS=i.NODE_DIMENSIONS_INCLUDE_LABELS=t.nodeDimensionsIncludeLabels,a.DEFAULT_INCREMENTAL=o.DEFAULT_INCREMENTAL=i.DEFAULT_INCREMENTAL=!t.randomize,a.ANIMATE=o.ANIMATE=i.ANIMATE=t.animate,a.TILE=t.tile,a.TILING_PADDING_VERTICAL="function"==typeof t.tilingPaddingVertical?t.tilingPaddingVertical.call():t.tilingPaddingVertical,a.TILING_PADDING_HORIZONTAL="function"==typeof t.tilingPaddingHorizontal?t.tilingPaddingHorizontal.call():t.tilingPaddingHorizontal};g.prototype.run=function(){var t,e,n=this.options;this.idToLNode={};var i=this.layout=new r,o=this;o.stopped=!1,this.cy=this.options.cy,this.cy.trigger({type:"layoutstart",layout:this});var a=i.newGraphManager();this.gm=a;var d=this.options.eles.nodes(),s=this.options.eles.edges();this.root=a.addRoot(),this.processChildrenList(this.root,this.getTopMostNodes(d),i);for(var l=0;l<s.length;l++){var u=s[l],g=this.idToLNode[u.data("source")],c=this.idToLNode[u.data("target")];g!==c&&0==g.getEdgesBetween(c).length&&(a.add(i.newEdge(),g,c).id=u.id())}var y=function(t,e){"number"==typeof t&&(t=e);var n=t.data("id"),i=o.idToLNode[n];return{x:i.getRect().getCenterX(),y:i.getRect().getCenterY()}},p=function a(){for(var r,d=function(){n.fit&&n.cy.fit(n.eles,n.padding),t||(t=!0,o.cy.one("layoutready",n.ready),o.cy.trigger({type:"layoutready",layout:o}))},s=o.options.refresh,l=0;l<s&&!r;l++)r=o.stopped||o.layout.tick();if(r){i.checkLayoutSuccess()&&!i.isSubLayout&&i.doPostLayout(),i.tilingPostLayout&&i.tilingPostLayout(),i.isLayoutFinished=!0,o.options.eles.nodes().positions(y),d(),o.cy.one("layoutstop",o.options.stop),o.cy.trigger({type:"layoutstop",layout:o}),e&&cancelAnimationFrame(e),t=!1;return}var u=o.layout.getPositionsData();n.eles.nodes().positions(function(t,e){if("number"==typeof t&&(t=e),!t.isParent()){for(var n=t.id(),i=u[n],o=t;null==i&&(i=u[o.data("parent")]||u["DummyCompound_"+o.data("parent")],u[n]=i,void 0!=(o=o.parent()[0])););return null!=i?{x:i.x,y:i.y}:{x:t.position("x"),y:t.position("y")}}}),d(),e=requestAnimationFrame(a)};return i.addListener("layoutstarted",function(){"during"===o.options.animate&&(e=requestAnimationFrame(p))}),i.runLayout(),"during"!==this.options.animate&&(o.options.eles.nodes().not(":parent").layoutPositions(o,o.options,y),t=!1),this},g.prototype.getTopMostNodes=function(t){for(var e={},n=0;n<t.length;n++)e[t[n].id()]=!0;return t.filter(function(t,n){"number"==typeof t&&(t=n);for(var i=t.parent()[0];null!=i;){if(e[i.id()])return!1;i=i.parent()[0]}return!0})},g.prototype.processChildrenList=function(t,e,n){for(var i=e.length,o=0;o<i;o++){var a,r,u=e[o],g=u.children(),c=u.layoutDimensions({nodeDimensionsIncludeLabels:this.options.nodeDimensionsIncludeLabels});if((a=null!=u.outerWidth()&&null!=u.outerHeight()?t.add(new d(n.graphManager,new s(u.position("x")-c.w/2,u.position("y")-c.h/2),new l(parseFloat(c.w),parseFloat(c.h)))):t.add(new d(this.graphManager))).id=u.data("id"),a.paddingLeft=parseInt(u.css("padding")),a.paddingTop=parseInt(u.css("padding")),a.paddingRight=parseInt(u.css("padding")),a.paddingBottom=parseInt(u.css("padding")),this.options.nodeDimensionsIncludeLabels&&u.isParent()){var y=u.boundingBox({includeLabels:!0,includeNodes:!1}).w,p=u.boundingBox({includeLabels:!0,includeNodes:!1}).h,E=u.css("text-halign");a.labelWidth=y,a.labelHeight=p,a.labelPos=E}this.idToLNode[u.data("id")]=a,isNaN(a.rect.x)&&(a.rect.x=0),isNaN(a.rect.y)&&(a.rect.y=0),null!=g&&g.length>0&&(r=n.getGraphManager().add(n.newGraph(),a),this.processChildrenList(r,g,n))}},g.prototype.stop=function(){return this.stopped=!0,this};var y=function(t){t("layout","cose-bilkent",g)};"undefined"!=typeof cytoscape&&y(cytoscape),t.exports=y}],n={};function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=n,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}(n(99916))}}]);